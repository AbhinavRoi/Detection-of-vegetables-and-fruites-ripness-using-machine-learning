# Detection-of-vegetables-and-fruites-ripness-using-machine-learning
HARDWARE LIST

Arduino Nano 33 IoT, 
DFRobot AS7341 11-Channel Visible Light Sensor,
Raspberry Pi 3B+ or 4,
10K Potentiometer (Long-Shaft),
1 Potentiometer Knob,
4 Button (6x6),
5 mm LED: Green,
5 mm LED: Red,
2 Breadboard.



Thanks to our evolved acuity, it is not struggling for us to detect ripeness by the appearance of a fruit or vegetable. However, nowadays, foods are a subject of mass production. Thus, we need a more reliable and effortless method to distinguish fruits and vegetables depending on their ripeness than the naked eye. In the hope of assisting food companies, grocery stores, and farmers in sorting fruits and vegetables, I developed this device that detects ripening stages by spectral color with a neural network model.

 

As fruits and vegetables ripen, they change color because of the four families of pigments:

chlorophyll (green)

carotenoids (yellow, red, orange)

flavonoids: anthocyanins + anthoxanthins (red, blue, purple)

betalains (red, yellow, purple)

These pigments are groups of molecular structures absorbing a specific set of wavelengths and reflecting the remainder. Unripe fruits are green because of chlorophyll in their cells. As they ripen, the
chlorophyll breaks down and is replaced by orange carotenoids and red anthocyanins. These compounds are antioxidants that prevent the fruit from spoiling too quickly in the air. Then, the enzymatic browning occurs and causes discoloration - turning brown. Enzymes function as a catalyst for chemical reactions instigating discoloration, such as:

hydroxylation of phenols
oxidation of phenols

 

After doing some research on color-changing processes as fruits and vegetables ripen, we decided to build an artificial neural network (ANN) based on the classification model to interpret the spectral color of varying fruits and vegetables to predict ripening stages.

 

Before building and testing my neural network model, We developed a web application in PHP to collate the spectral color data of fruits and vegetables generated by the AS7341 visible light sensor to create a ripening stages data set by spectral color. I used an Arduino Nano 33 IoT to send the data produced by the visible light sensor to the web application. Empirically, I assigned a ripening stage (label) while obtaining spectral color data for each fruit and vegetable by using four class buttons connected to the Nano 33 IoT:

 

Early Ripe

Partially Ripe

Ripe

Decay

 

After completing the data set, we built our artificial neural network (ANN) with TensorFlow to make predictions on the ripening stages (labels) based on spectral color.

 

Then, after testing, we conducted experiments with out neural network model to predict the ripening stages of varying fruits and vegetables by spectral color. As far as my experiments go, the model is working impeccably.



# Step 1: Developing a web application in PHP to collate spectral color data of fruits and vegetables

We developed this web application (Vegetables and Fruits Data Logger) in PHP to obtain spectral color data of fruits and vegetables from the AS7341 visible light sensor via the Arduino Nano 33 IoT and insert this data into a CSV file (spectral_color_database.csv) to create a ripening stages data set by spectral color.

The web application includes one file (index.php) and requires these parameters to insert a new row (entry) to the data set:

F1
F2
F3
F4
F5
F6
F7
F8
nir_1
nir_2
class

# Step 1.1: Setting up the web application on Raspberry Pi
After creating the PHP web application, we decided to run it on my Raspberry Pi, but you can run the application on any server as long as it is a PHP server.


![image](https://github.com/user-attachments/assets/7d0ea706-4485-4029-84b2-6fac3bba76c9)

![image](https://github.com/user-attachments/assets/82a51b6a-3848-48cc-bdca-11e01487a9cc)

# Step 3: Programmed the Arduino Nano 33 IoT to obtain the required parameters and send them to the web application

# Step 4: Creating the ripening stages data set based on spectral color
To train our neural network model on ripening stages by spectral color, we needed to collect spectral color data of varying fruits and vegetables to create a data set with eminent validity. Hence, we decided to use the AS7341 visible light sensor to collect spectral color data.

This sensor employs the new generation of AS7341 spectral sensor IC. It features eight channels for visible light, one channel for near-IR (NIR), one channel without a filter (Clear), and an extra channel distributed over ambient light flicker (Flicker). Also, it has six parallel 16-bit ADC channels for signal and data processing. Thanks to the two integrated LEDs with adjustable brightness, it can collect data even in a dark environment.

![image](https://github.com/user-attachments/assets/bd982b94-da58-4fbb-a28b-0e6d175e24b2)

We connected the AS7341 sensor to the Arduino Nano 33 IoT to send parameters and the assigned ripening stage labels to the PHP web application. After obtaining data, the web application inserts the required parameters by adding the current date parameter (Step 1) into the spectral_color_database.csv file (data set) under these columns:

F1
F2
F3
F4
F5
F6
F7
F8
NIR_1
NIR_2
Ripeness
Date

After completing programming and assembling the device, we selected eleven different fruits and vegetables to collect their ripeness classes by spectral color:
![image](https://github.com/user-attachments/assets/65b8d76a-a819-481a-bfbd-2b1d00443025)

![image](https://github.com/user-attachments/assets/9ae318ad-7678-47d7-8b3d-495d7194f457)

If the transferred data is inserted into the data set successfully, the device turns on the 5mm green LED. Otherwise, it turns on the 5mm red LED.
![image](https://github.com/user-attachments/assets/bf969298-ccbb-4e38-9d9c-067240f816de)

# Step 5: Building an Artificial Neural Network with TensorFlow
When we completed oue ripening stages by spectral color data set, we started to work on my artificial neural network (ANN) model to make predictions on the ripening stages of varying fruits and vegetables.

we decided to create our neural network model with TensorFlow in Python. Thus, first of all, we followed the steps below to grasp a better understanding of our data set:

Data Visualization
Data Scaling (Normalizing)
Data Preprocessing
Data Splitting
As explained in the previous steps, we  assigned ripening stage classes for each fruit and vegetable entry (input) while collecting spectral color data. Hence, we used these pre-defined classes as labels and did not need to preprocess my data set for assigning labels:

0 — Early Ripe
1 — Partially Ripe
2 — Ripe
3 — Decay
After scaling (normalizing) and preprocessing inputs in my data set, we elicited ten input variables and one label for each fruit and vegetable entry, classified with the four mentioned classes. Then, we built an artificial neural network model with TensorFlow and trained it with our data set to obtain the best possible results and predictions.

Layers:

10 [Input]
16 [Hidden]
32 [Hidden]
64 [Hidden]
128 [Hidden]
256 [Hidden]
4 [Output]

![image](https://github.com/user-attachments/assets/060837ec-f14d-4b52-843a-c1f100ff1b06)

# Step 5.1: Visualizing the ripening stages data set based on spectral color
Before diving into building a neural network model, it is crucial to understand the given data set to pass the model appropriately formatted data.
![image](https://github.com/user-attachments/assets/5de516b2-fd4c-4e19-8081-6a4627275f12)
we performed this graphical visualisation for all the the data, for F1 to F8 against NIR.

# Step 5.2: Training the model (ANN) on the ripening stage classes based on spectral color
After preprocessing and scaling (normalizing) the ripening stages data set to create inputs and labels, I split them as training (95%) and test (5%) sets.

Then, we built our artificial neural network (ANN) model by using Keras and trained it with the training set for 200 epochs.

![image](https://github.com/user-attachments/assets/fe04e436-1200-4aff-83ec-aa169b250864)

# Step 5.3: Evaluating the model

After building and training our artificial neural network model, we tested its accuracy and validity by utilizing the testing set (inputs and labels).

The evaluated accuracy of the model is 0.94.

![image](https://github.com/user-attachments/assets/bab56594-61db-4c13-b0ea-4a164d296b26)




















